+++
title = "–°–æ–∑–¥–∞–Ω–∏–µ API –Ω–∞ –±–∞–∑–µ Symfony 5. –ß–∞—Å—Ç—å 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è"
date = "2021-01-01T20:20:50+03:00"
tags = ["php", "backend", "symfony", "api"]
+++

[–°–æ–∑–¥–∞–Ω–∏–µ API –Ω–∞ –±–∞–∑–µ Symfony 5. –ß–∞—Å—Ç—å 1. –í–≤–µ–¥–µ–Ω–∏–µ]({{< relref "symfony-api-1" >}})

[–°–æ–∑–¥–∞–Ω–∏–µ API –Ω–∞ –±–∞–∑–µ Symfony 5. –ß–∞—Å—Ç—å 3. –ù–∞—á–∞–ª–æ –ø—Ä–æ–µ–∫—Ç–∞]({{< relref "symfony-api-3" >}})

## –ù–∞—á–∏–Ω–∞–µ–º —Å –º–µ–ª–æ—á–µ–π

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –Ω–∞—á–∞—Ç—å —á—Ç–æ-—Ç–æ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ. –í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏,
–Ω–∞—Å—Ç—Ä–æ–∏–º **docker-compose**, —Å–æ–∑–¥–∞–¥–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É—Å–ª–æ–≤–∏–º—Å—è –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –∫–æ–Ω–≤–µ–Ω—Ü–∏—è–º –∏ —Ç.–¥. –°—Ä–∞–∑—É –æ–≥–æ–≤–æ—Ä—é—Å—å, —á—Ç–æ —è –Ω–∏–∫–æ–≥–¥–∞
–≤ –∂–∏–∑–Ω–∏ –Ω–µ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª –Ω–∞ windows, —Ç–æ–ª—å–∫–æ –Ω–∞ linux –∏–ª–∏ mac, –ø–æ—ç—Ç–æ–º—É –∫–∞–∫–∏–µ-—Ç–æ –≤–µ—â–∏ –Ω–∞ –≤–∏–Ω–¥–µ –ø—Ä–æ—Å—Ç–æ —Ç—É–ø–æ –Ω–µ –≤–∑–ª–µ—Ç—è—Ç.

–ü–µ—Ä–≤–æ–µ, —á—Ç–æ –º—ã –¥–µ–ª–∞–µ–º –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, —Å–æ–∑–¥–∞–µ–º [.editorconfig](https://editorconfig.org/):

```cfg
# editorconfig.org
root = true

[*]
charset = utf-8
end_of_line = LF
trim_trailing_whitespace = true
insert_final_newline = true

[*.{yml,yaml,php,html,twig,js,xml,xml.dist,json}]
indent_style = space
indent_size = 4

[{Makefile,Dockerfile}]
indent_style = tab
indent_size = 4
```

–≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –±–æ–ª—å—à–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É—Ç–∞—Ç—å —Ç–∞–±—ã —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç –≤ –¥–∏—Ñ—Ñ–µ), –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –∫–æ–Ω—Ü–µ
—Å—Ç—Ä–æ–∫ –∏ —Ç.–¥. –õ—é–±–∞—è **IDE** —Å–∞–º–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ (–≤–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–∂–µ—Ç
–ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–ª–∞–≥–∏–Ω). –ù–µ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è —Å –∫–æ–º–∞–Ω–¥–æ–π –∏ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ –∫–æ–¥ —Å—Ç–∞–π–ª –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ –Ω–æ–≤—ã—Ö
—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –í–æ–∑—å–º–µ–º –∑–∞ –ø—Ä–∞–≤–∏–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ, —á—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ ‚ò∫Ô∏è –¥–∞–∂–µ –º–µ–ª–æ—á–∏.

## –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ **PHP** —ç—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π –≥–µ–º–æ—Ä–æ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –≤–∞–º —Ç—Ä–µ–±—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —è–∑—ã–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
–Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö üßê –ü–æ—ç—Ç–æ–º—É, –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–∫–µ—Ä –¥–ª—è –ª—é–±—ã—Ö —Ç–µ–ª–æ–¥–≤–∏–∂–µ–Ω–∏–π, –±—É–¥—å —Ç–æ **composer** –∏–ª–∏
PHP-–±–∏–Ω–∞—Ä–Ω–∏–∫.

–ü—Ä–µ–∂–¥–µ, —á–µ–º –º—ã —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞–µ–º, –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω—É–∂–Ω—ã–µ –Ω–∞–º –∫–æ–º–∞–Ω–¥—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã
–∏–∑ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞. –¢–∞–∫–∏—Ö –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ:

- **Phing** —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ **Ant** –¥–ª—è PHP. –†–∞–Ω—å—à–µ –∏–º–µ–ª –≤–µ—Å, –Ω–æ –æ–Ω –æ—á–µ–Ω—å —É—Å—Ç–∞—Ä–µ–ª –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è;
- **Composer-—Å–∫—Ä–∏–ø—Ç—ã** —Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ PHP, –∞ –∑–∞–ø—É—Å–∫ –µ–≥–æ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–∑-–ø–æ–¥ –¥–æ–∫–µ—Ä–∞ –Ω–∞–º –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞–ø—É—Å–∫
  **docker-compose** –∏–∑-–ø–æ–¥ –¥–æ–∫–µ—Ä-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–º–µ–µ—Ç —Ä—è–¥ –Ω—é–∞–Ω—Å–æ–≤ —Ç–∏–ø–∞ –ø—Ä–æ–±–ª–µ–º —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º;
- –í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–ª–∞—Å—Å–∏–∫–∞ - **make**.

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `docker/runtime/.gitignore` —Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–º - `*`, —á—Ç–æ–±—ã –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤
—Å–µ–±–µ. –≠—Ç–∞ –ø–∞–ø–∫–∞ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –¥–æ–∫–µ—Ä–µ. –î–∞–ª–µ–µ, –Ω—É–∂–Ω–æ
—Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ `Makefile` —Å –Ω–µ–±–æ–ª—å—à–∏–º –±–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç –∫–æ–¥–æ–º:

```make
#
# BEGIN DEV
#

UNAME=$(shell uname)
USERID=$(shell id -u)
GROUPID=$(shell id -g)
DOCKERUSER="$(USERID):$(GROUPID)"
DOCKER_RUN_OPTS=-u $(DOCKERUSER) --rm -it
COMPOSER_IMAGE=composer:2.0.3
PHP_DEV_IMAGE=php-custom:7.4-fpm-buster

ifeq ($(UNAME), Linux)
	USERGROUP:=$(shell getent group $(GROUPID) | cut -d: -f1)
endif

ifeq ($(UNAME), Darwin)
	USERGROUP=staff
endif

.PHONE: dev-prepare-runtime
dev-prepare-runtime:
	@echo -e "Preparing runtime group and passwd files..."
	@echo "$(USER):x:$(USERID):$(GROUPID):$(USERGROUP):/home/$(USER):/bin/bash" > $(PWD)/docker/runtime/passwd
	@echo "$(USERGROUP):x:$(GROUPID):$(USER)" > $(PWD)/docker/runtime/group

.PHONY: dev-install
dev-install: dev-prepare-runtime
	@docker run $(DOCKER_RUN_OPTS) -v $(PWD):/app -v /tmp:/tmp $(COMPOSER_IMAGE) install

.PHONY: dev-composer-require
dev-composer-require:
	@docker run $(DOCKER_RUN_OPTS) -v $(PWD):/app -v /tmp:/tmp $(COMPOSER_IMAGE) require $(PACKAGE)

.PHONY: dev-composer-require-dev
dev-composer-require-dev:
	@docker run $(DOCKER_RUN_OPTS) -v $(PWD):/app -v /tmp:/tmp $(COMPOSER_IMAGE) require --dev $(PACKAGE)

.PHONY: dev-composer-update
dev-composer-update:
	@docker run $(DOCKER_RUN_OPTS) -v $(PWD):/app -v /tmp:/tmp $(COMPOSER_IMAGE) update $(PACKAGE)

.PHONY: dev-docker-build
dev-docker-build:
	@docker build -t php-custom:7.4-fpm-buster -f docker/images/Dockerfile.dev docker/images

#
# END DEV
#
```

–í—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä–µ–º–Ω–æ, –Ω–æ –∑–¥–µ—Å—å –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ –ø—Ä–æ—Å—Ç–æ. –ö–ª—é—á–µ–≤–æ–µ –∑–¥–µ—Å—å - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏
–µ–≥–æ –≥—Ä—É–ø–ø—ã, —á—Ç–æ–±—ã —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã `passwd` –∏ `group`. –≠—Ç–æ –Ω—É–∂–Ω–æ? —á—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –¥–æ–∫–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏ —Å
–ø—Ä–∞–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ö–æ—Å—Ç–µ–≤–æ–π –û–°. –î–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –¥–ª—è linux –∏ –¥–ª—è mac. –î–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É:

```shell
$ make dev-install
```

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —Å–æ–∑–¥–∞–¥–∏–º `docker/images/Dockerfile.dev`:

```dockerfile
FROM php:7.4-fpm-buster
ARG DEBIAN_FRONTEND=noninteractive
WORKDIR /project
ENV LANG=ru_RU.UTF-8 \
	LC_ALL=ru_RU.UTF-8 \
	LANGUAGE=ru_RU.UTF-8 \
	COMPOSER_ALLOW_SUPERUSER=1 \
	COMPOSER_HOME=/tmp

COPY --from=composer /usr/bin/composer /usr/bin/composer
```

–≠—Ç–æ –±—É–¥–µ—Ç –æ–±—Ä–∞–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –°–µ–π—á–∞—Å —Ç–∞–º —Ç–æ–ª—å–∫–æ **composer**, –Ω–æ –ø–æ–∑–∂–µ –º—ã –¥–æ–±–∞–≤–∏–º –≤ –Ω–µ–≥–æ **xdebug** –∏
–≤–µ—Ä–æ—è—Ç–Ω–æ, –∫–∞–∫–∏–µ-—Ç–æ –µ—â–µ –º–æ–¥—É–ª–∏. –ù–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏ —Ç–æ–≥–¥–∞ –º—ã –≤—ã–¥–µ–ª–∏–º
–æ–±—â—É—é —á–∞—Å—Ç—å –≤ —Ç.–Ω. –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–ø–∏–ø–∞—Å—Ç—ã. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, dev-–æ–±—Ä–∞–∑ –±—É–¥–µ—Ç –ª–µ–∂–∞—Ç—å —Ä—è–¥–æ–º —Å –ø—Ä–æ–µ–∫—Ç–æ–º, –Ω–æ
–æ–±—ã—á–Ω–æ, –∏ dev –∏ prod –∏ –±–∞–∑–æ–≤—ã–π —É–Ω–æ—Å—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.
–ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏—Ö –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–∫—É—Å—É. –°–æ–±–µ—Ä–µ–º –Ω–∞—à dev-–æ–±—Ä–∞–∑ –∫–æ–º–∞–Ω–¥–æ–π:

```shell
$ make dev-docker-build
```

–ü–æ—Å–ª–µ–¥–Ω–µ–µ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî –Ω–∞–ø–∏—Å–∞—Ç—å **docker-compose** –∫–æ–Ω—Ñ–∏–≥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ. –î–ª—è —Å—Ç–∞—Ä—Ç–∞ –Ω–∞–º –±—É–¥–µ—Ç
–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 2—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: **nginx** –∏ **php-fpm**. –ù–∞—á–Ω–µ–º —Å –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è nginx, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–µ—Å—Ç–∏–º –≤ `docker/build/nginx/dev/conf.d/default.conf`:

```nginx
server {
  server_name _;
  root /project/public;

  error_log /dev/stderr debug;
  access_log /dev/stdout;

  underscores_in_headers on;

  location = /favicon.ico {
    access_log /dev/null;
    empty_gif;
  }

  location / {
    try_files $uri /index.php$is_args$args;
  }

  location ~ ^/index\.php(/|$) {
    fastcgi_pass fpm:9000;
    fastcgi_split_path_info ^(.+\.php)(/.*)$;
    include fastcgi_params;

    fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
    fastcgi_param DOCUMENT_ROOT $realpath_root;
    internal;
  }

  location ~ \.php$ {
    fastcgi_pass fpm:9000;
    fastcgi_split_path_info ^(.+\.php)(/.*)$;
    include fastcgi_params;

    fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
    fastcgi_param DOCUMENT_ROOT $realpath_root;
  }
}
```

–ò –¥–∞–ª–µ–µ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ `docker-compose.dev.yml`:

```yaml
version: '3.5'

services:

    nginx:
        image: nginx:1.15-alpine
        container_name: nginx
        ports:
            - 8080:80
        volumes:
            - "$PWD/docker/build/nginx/dev/conf.d:/etc/nginx/conf.d"
            - "$PWD:/project"
        depends_on:
            - fpm
        networks:
            - symfony-api-demo

    fpm:
        image: "$PHP_DEV_IMAGE"
        user: "$DOCKERUSER"
        container_name: fpm
        environment:
            XDEBUG_CONFIG: "remote_connect_back=1 remote_enable=1"
        volumes:
            - "$PWD/docker/runtime/passwd:/etc/passwd:ro"
            - "$PWD/docker/runtime/group:/etc/group:ro"
            - "$PWD:/project"
        networks:
            - symfony-api-demo

networks:
    symfony-api-demo:
        name: symfony-api-demo
```

–ù–∏—á–µ–≥–æ –Ω–µ–æ–±—ã—á–Ω–æ–≥–æ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ—Ç. –ò –ø–æ—Å–ª–µ–¥–Ω–∏–π —à—Ç—Ä–∏—Ö, –¥–æ–±–∞–≤–∏–º –∑–∞–ø—É—Å–∫ –≤ **Makefile**:

```make
DOCKERCOMPOSE=DOCKERUSER=$(DOCKERUSER) COMPOSER_IMAGE=$(COMPOSER_IMAGE) PHP_DEV_IMAGE=$(PHP_DEV_IMAGE) docker-compose
DOCKERCOMPOSE_UP_OPTS=--force-recreate --abort-on-container-exit --build

.PHONY: dev-start
dev-start:
	@$(DOCKERCOMPOSE) -f docker-compose.dev.yml up $(DOCKERCOMPOSE_UP_OPTS)
```

–í –ø—Ä–∏–Ω—Ü–∏–ø–µ –≤—Å–µ. –ß—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:

```shell
$ make dev-start
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ë–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Ç–æ–∂–µ –ø–∏—à—É—Ç –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –¥–æ–ø—É—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏. –ú—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–æ–∂–µ–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ
—Ç–æ, —á—Ç–æ –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –º–æ–∂–µ–º —É–∑–Ω–∞—Ç—å –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö —á—Ç–æ–±—ã –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å—Å—è. –ü–æ–º–∏–º–æ
—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Ç–∏–ø–∞ **sonarqube**, –µ—Å—Ç—å 2 –ø—É—Ç–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç
–Ω–∏–∫–∞–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:

- –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **Symfony** –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏ –µ–≥–æ —á–µ—Ä–µ–∑ cli-—É—Ç–∏–ª–∏—Ç—É, —Ç–æ –º–æ–∂–µ–º –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
–∫–æ–º–∞–Ω–¥—É `symfony security:check`. –û–Ω–∞ –≤—ã–∫–∞—á–∏–≤–∞–µ—Ç –±–∞–∑—É –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ª–æ–∫–∞–ª—å–Ω–æ. –ï—Å—Ç—å
–ø—Ä–∞–≤–¥–∞ –∏ –Ω–µ–±–æ–ª—å—à–æ–π –º–∏–Ω—É—Å, cli-—É—Ç–∏–ª–∏—Ç–∞ **–Ω–µ open source**. –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –±—ã –Ω–µ –Ω–∞ **Symfony**, —Ç–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã
–∑–∞—é–∑–∞—Ç—å [SensioLabs Security Checker](https://github.com/sensiolabs/security-checker), –Ω–æ –æ–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ª–æ–∫-—Ñ–∞–π–ª –Ω–∞
—É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.
- –ë—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –≤—ã–∑–æ–≤ –∫–æ–º–∞–Ω–¥—ã —Å–¥–µ–ª–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ö –ø—Ä–∏–º–µ—Ä—É, –∫–æ–≥–¥–∞ –≤–∞—à CI –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ –∏–º–µ—é—â–∏–º
–¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏–ª–∏ –ø—Ä–æ–∫—Å–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö–æ–¥–∏—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Ä–ª–æ–≤. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
[Roave/SecurityAdvisories](https://github.com/Roave/SecurityAdvisories). –≠—Ç–æ "–ø—É—Å—Ç–æ–π" composer-–ø–∞–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π
–ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∑–Ω–∞–∫–æ–º—ã–µ —É—è–∑–≤–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã–µ, —Ç–µ–º —Å–∞–º—ã–º –Ω–µ –ø–æ–∑–≤–æ–ª—è—è –∏—Ö —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.

## –õ–∏–Ω—Ç–µ—Ä—ã –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã

–î–∞–ª—å—à–µ, –æ–±–º–∞–∂–µ–º—Å—è –ª–∏–Ω—Ç–µ—Ä–∞–º–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º–∏. –ù–∞—á–Ω–µ–º —Å [php-cs-fixer](https://cs.symfony.com/):

```shell
$ make dev-composer-require-dev PACKAGE=friendsofphp/php-cs-fixer
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `.php_cs.dist`, –∫–æ—Ç–æ—Ä—ã–π –≤–ø–æ–ª–Ω–µ –æ–∫, –Ω–æ –¥–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º –µ—â–µ 1 –ø—Ä–∞–≤–∏–ª–æ:

```php
<?php

// ...

return PhpCsFixer\Config::create()
    ->setRules([
        '@Symfony' => true,
        '@Symfony:risky' => true, // <---- –¥–æ–±–∞–≤–∏—Ç—å —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
        'array_syntax' => ['syntax' => 'short'],
    ])
    ->setRiskyAllowed(true)  // <--- —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
    ->setFinder($finder);
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∫–æ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ—Ñ–∏–∫—Å–∞. –†–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–º–∏ –æ–Ω–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ—Ç–æ–º—É —á—Ç–æ
–∞–≤—Ç–æ—Ñ–∏–∫—Å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–¥–∞, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ª—É—á—à–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://cs.symfony.com/doc/rules/index.html).

–î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ, —Å—É—â–µ—Å—Ç–≤—É—é—Ç 2 —É—Ç–∏–ª–∏—Ç—ã: [phpstan](https://phpstan.org/) –∏ [psalm](https://psalm.dev/).
–ü–µ—Ä–≤—ã–π –±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π, –≤–æ–∑—å–º–µ–º –µ–≥–æ:

```shell
$ make dev-composer-require-dev PACKAGE="phpstan/phpstan phpstan/phpstan-symfony"
```

–î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `phpstan.neon` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```yaml
parameters:
  symfony:
    container_xml_path: var/cache/dev/App_KernelDevDebugContainer.xml
  level: 8
  fileExtensions:
    - php
  paths:
    - src
    - tests
includes:
  - vendor/phpstan/phpstan-symfony/extension.neon
  - vendor/phpstan/phpstan-symfony/rules.neon
```

–ö–∞–∫ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, –º—ã –±—É–¥–µ–º –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∂–µ—Å—Ç–∏ ü§¨ –î–ª—è —Ç–µ—Å—Ç–æ–≤ –µ–≥–æ –º–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –æ—Ç–∫–ª—é—á–∏—Ç—å, –Ω–æ
–±—ã–≤–∞—é—Ç —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –æ–Ω —Å–ø–∞—Å–∞–µ—Ç (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É tests –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –ª–∏–Ω—Ç–µ—Ä –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω, –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞).
–ö–∞–∫–∏–µ-—Ç–æ —Å–∞–º—ã–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥ —Ä–µ–≥—É–ª—è—Ä–∫–æ–π.

–ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥, –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ –≤—Å–µ—Ö –ª–∏–Ω—Ç–µ—Ä–æ–≤ –≤ **Makefile**:

```make
.PHONY: lint
lint:
	bin/console lint:container
	bin/console lint:yaml config/services.yaml --parse-tags
	vendor/bin/php-cs-fixer fix -v --dry-run --stop-on-violation
	vendor/bin/phpstan analyse --memory-limit=1G

.PHONY: dev-lint
dev-lint:
	@docker run $(DOCKER_RUN_OPTS) -v $(PWD):/project $(PHP_DEV_IMAGE) make lint
```

–í–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `make dev-lint`, –±—É–¥—É –æ—à–∏–±–∫–∏, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö —Å–∞–º–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

–°—Ä–∞–∑—É —É—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —á–∞—Å—Ç—è—Ö. –î–æ–±–∞–≤–∏–º **xdebug** –≤ dev-–æ–±—Ä–∞–∑:

```dockerfile
RUN pecl install xdebug-2.8.1 && \
    docker-php-ext-enable xdebug
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –µ–≥–æ. –ü–ª—é—Å, –¥–æ–±–∞–≤–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã—Ö composer-–ø–∞–∫–µ—Ç–æ–≤:

```shell
$ make dev-composer-require PACKAGE="sensio/framework-extra-bundle symfony/monolog-bundle"
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **postgres**. –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å **Makefile**, –∏–∑–º–µ–Ω–∏–≤ `dev-install` —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º
–≤—ã–∑–æ–≤–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –ø–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±–∞–∑—ã. –í—ã–Ω–µ—Å–µ–º —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –Ω–æ–≤—ã–π —Ç–∞—Ä–≥–µ—Ç `dev-prepare-fs`:

```make
.PHONY: dev-prepare-fs
dev-prepare-fs:
    mkdir -p $(PWD)/docker/data/postgres/data || true

.PHONY: dev-install
dev-install: dev-prepare-fs dev-prepare-runtime
    # ...
```

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º, –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `docker/data/.gitignore` —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º `*`. –ó–∞—Ç–µ–º –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–∞–Ω–¥—É:

```shell
$ make dev-prepare-fs
```

–í `docker-compose.dev.yml` –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å:

```yaml
postgres:
  image: postgres:13.1-alpine
  user: "$DOCKERUSER"
  volumes:
      - "$PWD/docker/runtime/passwd:/etc/passwd:ro"
      - "$PWD/docker/runtime/group:/etc/group:ro"
      - "$PWD/docker/data/postgres/data:/var/lib/postgresql/data"
  environment:
      POSTGRES_DB: symfony-api-demo
      POSTGRES_PASSWORD: password
```

–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω—É–∂–Ω–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç—å—Å—è, —á—Ç–æ **php-fpm** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ –ø–æ–¥–Ω—è—Ç–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö,
–≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å –µ—Å–ª–∏ –∫ –Ω–µ–º—É –æ–±—Ä–∞—Ç–∏—Ç—Å—è –∫–ª–∏–µ–Ω—Ç –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –±–∞–∑–∞ –µ—â–µ –Ω–µ –ø–æ–¥–Ω—è–ª–∞—Å—å, –∞
–ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –æ–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏. –î–∞–∂–µ –µ—Å–ª–∏ –º—ã –Ω–µ –±—É–¥–µ–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É, —Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏
—Å—Ç–∞—Ä—Ç–µ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å. –¢–∞–∫–∂–µ, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å `depends_on` –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ **fpm**, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ—Ç
–ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞.

–ß—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –æ–±—Ä–∞–∑ —Å–∫—Ä–∏–ø—Ç [wait-for-it.sh](https://github.com/vishnubob/wait-for-it)
–∏ `command` –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ **fpm**:

```yaml
command: /wait-for-it.sh postgres:5432 -t 300 -- php-fpm -F -O
```

–ü–æ–∫–∞ —Å —Å–æ—Ñ—Ç–æ–º –∑–∞–∫–æ–Ω—á–∏–ª–∏, –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é **ORM** –∫ –ø—Ä–æ–µ–∫—Ç—É:

```shell
$ make dev-composer-require PACKAGE="symfony/orm-pack"
$ make dev-composer-require-dev PACKAGE="symfony/maker-bundle"
```

DSN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–ø–∏—à–µ–º –≤ `.env.local`:

```cfg
DATABASE_URL="postgresql://postgres:password@postgres:5432/symfony-api-demo?serverVersion=13&charset=utf8"
```

–í `Dockerfile.dev` –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø–∞–∫–µ—Ç–∞ `libpq-dev`, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –º–æ–¥—É–ª—è `pgsql` –∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É –º–æ–¥—É–ª–µ–π
`pdo_pgsql` –∏ `pgsql`:

```dockerfile
RUN apt-get update -y && \
    apt-get install -y libpq-dev && \
    rm -rf /var/lib/apt/lists/*

RUN docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql && \
    docker-php-ext-install -j$(getconf _NPROCESSORS_ONLN) pdo_pgsql pgsql
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ –∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ–∑—é–º–µ

–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —É –Ω–∞—Å –µ—Å—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –°–æ–∑–¥–∞–¥–∏–º —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
–≤ —Ñ–∞–π–ª–µ `src/Controller/HelloController.php` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```php
<?php

declare(strict_types=1);

namespace App\Controller;

use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Annotation\Route;

class HelloController
{
    /**
     * @Route("/status", name="status")
     */
    public function index(): Response
    {
        return new JsonResponse(['status' => true]);
    }
}
```

–í—ã –¥–æ–ª–∂–Ω—ã –±—É–¥–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –æ—Ç–≤–µ—Ç, –µ—Å–ª–∏ –¥–µ—Ä–Ω–∏—Ç–µ [http://localhost:8080/status](http://localhost:8080/status).

–ù–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞. –í–µ—Å—å –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏](https://github.com/ns3777k/symfony-api-demo).
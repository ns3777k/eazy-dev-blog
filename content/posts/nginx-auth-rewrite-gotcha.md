+++
title = "–†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ nginx"
date = "2020-06-09T00:13:50+03:00"
tags = ["nginx"]
+++

–°–µ–≥–æ–¥–Ω—è –Ω–µ–º–Ω–æ–∂–∫–æ –ø—Ä–µ–ø–∞—Ä–Ω–µ–º **nginx**.

–ö–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è –Ω–∞–∑–∞–¥ —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –∫–µ–π—Å–æ–º –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ **nginx**. –ö–µ–π—Å, –∫–∞–∑–∞–ª–æ—Å—å –±—ã, –ø—Ä–æ—Å—Ç–æ–π - –Ω—É–∂–Ω–æ
–ø—Ä–∏–∫—Ä—É—Ç–∏—Ç—å *basic-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é* –Ω–∞ `location`:

```text
location = /check/ {
    satisfy all;
    
    allow x.x.x.x;
    allow y.y.y.y;
    deny all;
    
    auth_basic "Auth required";
    auth_basic_user_file /etc/nginx/passwords/base;
    
    return 302 /userid/;
}
```

–ö–∞–∑–∞–ª–æ—Å—å –±—ã –≤—Å–µ –ø—Ä–æ—Å—Ç–æ, –Ω–æ –Ω–µ—Ç. –≠—Ç–æ—Ç –∫—É—Å–æ–∫ –∫–æ–Ω—Ñ–∏–≥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–∞–∫, –∫–∞–∫ –≤—ã –æ–∂–∏–¥–∞–µ—Ç–µ üòè –ö—É—Ä–∞–ª–Ω–µ–º:

```shell script
$ curl -I localhost:9999
HTTP/1.1 302 Moved Temporarily
Location: http://localhost/userid/
```

–ê –≥–¥–µ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è? –û—Ç–≤–µ—Ç, –∫–∞–∫ –≤—Å–µ–≥–¥–∞, –º–æ–∂–Ω–æ [–Ω–∞–π—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](http://nginx.org/en/docs/dev/development_guide.html#http_phases) üòï

–í **nginx** —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ñ–∞–∑—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Ñ–∞–∑–∞ —Ä–µ—Ä–∞–π—Ç–∞ (`NGX_HTTP_SERVER_REWRITE_PHASE`) —Ä–∞–±–æ—Ç–∞–µ—Ç **–î–û** —Ñ–∞–∑—ã
–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`NGX_HTTP_ACCESS_PHASE`).

–°–∞–º–æ–µ –ø–æ—Ä–∞ –∑–∞–¥—É–º–∞—Ç—å—Å—è –æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ –µ—Å–ª–∏ —á—Ç–æ, –≤–æ—Ç –≥—Ä—è–∑–Ω—ã–π —Ö–∞–∫:

```text
location = /check/ {
    // ...
    error_page 404 = @do_stuff;
}

location @do_stuff {
    return 302 /userid/;
}
```

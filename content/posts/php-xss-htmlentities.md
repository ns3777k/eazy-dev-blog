+++
title = "Специфическая XSS через htmlentities или htmlspecialchars в PHP"
date = "2020-12-30T20:28:20+03:00"
tags = ["php", "backend", "безопасность", "frontend"]
+++

Столкнулся на днях с очень старой дыркой на одном проекте, которая раньше встречалась практически в каждом проекте на
Битриксе и до сих пор актуальна :-) Чтобы довести ситуацию до **XSS**, нужно:

1. Проект на php;
2. Верстальщик, решивший, что писать одинарные кавычки моднее, чем двойные;
3. Разработчик, слабо понимающий в безопасности

Результатом этого, может быть шаблон типа такого:

```html
<form method="GET">
    <input name="search" placeholder='Search' value='<?=htmlentities($variable);?>' />
</form>
```

Ни `htmlentities` ни `htmlspecialchars` **не фильтруют** одинарную кавычку по умолчанию, поэтому рабочий пейлоад
должен начинаться именно с нее: `' onload=alert(1)`.

Современные шаблонизаторы типа `twig` и `blade` изначально эскейпят одинарные кавычки, но если вам довелось работать с
php-шаблонами, то нужно иметь это в веду.
